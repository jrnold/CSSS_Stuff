Relational models for contingency tables

1

Anna Klimova, Tam´as Rudas, and Adrian Dobra

Working Paper no. 109
Center for Statistics and the Social Sciences
University of Washington
April 1, 2011

1 Anna

Klimova is a Graduate student, Department of Statistics, University of Washington, Box
355845, Seattle WA 98195-4322; e-mail: klimova@u.washington.edu. Tam´as Rudas is Professor
of Statistics and Head, Department of Statistics at E¨otv¨os Lor´and University, Budapest, Hungary;
Aﬃliate Professor, Department of Statistics, University of Washington; e-mail: rudas@tarki.hu.
Adrian Dobra is Assistant Professor of Statistics and Nursing, University of Washington; e-mail:
adobra@u.washington.edu; web: https://www.stat.washington.edu/people/adobra/. The
work of Anna Klimova and Adrian Dobra was supported in part by NIH Grant R01 HL092071.
Tam´as Rudas was supported in part by Grant No TAMOP 4.2.1./B-09/1/KMR-2010-0003 from
the European Union and the European Social Fund. He is also a Recurrent Visiting Professor at
the Central European University and the moral support received is acknowledged. The authors
wish to thank Thomas Richardson for his comments and discussions.

Abstract
The paper considers general multiplicative models for complete and incomplete contingency
tables that generalize log-linear and several other models and are entirely coordinate free.
Suﬃcient conditions of the existence of maximum likelihood estimates under these models are
given, and it is shown that the usual equivalence between multinomial and Poisson likelihoods
holds if and only if an overall eﬀect is present in the model. If such an eﬀect is not assumed,
the model becomes a curved exponential family and a related mixed parameterization is given
that relies on non-homogeneous odds ratios. Several examples are presented to illustrate the
properties and use of such models.
KEY WORDS: Contingency tables, curved exponential family, exponential family,
generalized odds ratios, maximum likelihood estimate,
multiplicative model

Introduction
The main objective of the paper is to develop a new class of models for the set of all strictly
positive distributions on contingency tables and on some sets of cells that have a more general
structure. The proposed relational models are motivated by traditional log-linear models,
quasi models and some other multiplicative models for discrete distributions that have been
discussed in the literature.
Under log-linear models (Bishop et al., 1975), cell probabilities are determined by multiplicative eﬀects associated with various subsets of the variables in the contingency table.
However, some cells may have other characteristics in common, and there always has been
interest in models that also allow for multiplicative eﬀects that are associated with those
characteristics. Examples, among others, include quasi models (Goodman, 1968, 1972),
topological models (Hauser, 1978; Hout, 1983), indicator models (Zelterman & Youn, 1992),
rater agreement-disagreement models (Tanner & Young, 1985a,b), two-way subtable sum
models (Hara et al., 2009). All these models, applied in diﬀerent contexts, have one common
idea behind them. A model is generated by a class of subsets of cells, some of which may
not be induced by marginals of the table, and, under the model, every cell probability is the
product of eﬀects associated with subsets the cell belongs to. This idea is generalized in the
relational models framework.
The outline of the paper is as follows. The definition of a table and the definition of
a relational model generated by a class of subsets of cells in the table are given in Section
1. The cells are characterized by strictly positive parameters (probabilities or intensities); a
table is a structured set of cells. Under the model, the parameter of each cell is the product
of eﬀects associated with the subsets in the generating class, to which the cell belongs. Two
examples are given to illustrate this definition. Example 1.1 shows how traditional log-linear
models fit into the framework and Example 1.2 describes how multiplicative models for
incomplete contingency tables are handled.
The degrees of freedom and the dual representation of relational models are discussed in
Section 2. Every relational model can be stated in terms of generalized odds ratios. The
minimal number of generalized odds ratios required to specify the model is equal to the
number of degrees of freedom in this model.
The models for probabilities that include the overall eﬀect and all relational models for
intensities are regular exponential families. Under known conditions (cf. Barndorﬀ-Nielsen,
1978), the maximum likelihood estimates for cell frequencies exist and are unique; the observed values of canonical statistics are equal to their expected values. If the overall eﬀect
is not present, a relational model for probabilities forms a curved exponential family. The

1

maximum likelihood estimates in the curved case exist and are unique under the same condition as for regular families; the observed values of canonical statistics are proportional to
their expected values. The maximum likelihood estimates for cell frequencies under a model
for intensities and under a model for probabilities, when the model matrix is the same, are
equal if and only if the model for probabilities is a regular family. These facts are proved in
Section 3.
A mixed parameterization of finite discrete exponential families is discussed in Section
4. Any relational model is naturally defined under this parameterization: the corresponding
generalized odds ratios are fixed and the model is parameterized by remaining mean-value
parameters. The distributions of observed values of subset sums and generalized odds ratios
are variation independent and, in the regular case, specify the table uniquely.
Two applications of the framework are presented in Section 5. These are the analysis
of social mobility data and the analysis of a valued network with given attributes. These
two examples suggest that the flexibility of the framework and substantive interpretation of
parameters make relational models appealing for many settings.

1

Definition and Log-linear Representation of Relational Models

Let Y1 , . . . , YK be the discrete random variables modeling certain characteristics of the population of interest. Denote the domains of the variables by Y1 , . . . , YK respectively. A point

(y1 , y2 , . . . , yK ) ∈ Y1 × · · · × YK generates a cell if and only if the outcome (y1 , y2 , . . . , yK )
appears in the population. A cell (y1 , y2 , . . . , yK ) is called empty if the combination is not
included in the design.

Let I denote the lexicographically ordered set of non-empty cells in Y1 × · · · × YK , and

|I| denote the cardinality of I. Since the case, when I = Y1 × · · · × YK , corresponds to a
classical complete contingency table, then the set I is also called a table.
Depending on the procedure that generates data on I, the population may be charac-

terized by cell probabilities or cell intensities. The parameters of the true distribution will
be denoted by δ = {δ(i), for i ∈ I}. In the case of probabilities, δ(i) = p(i) ∈ (0, 1), where
�
i∈I p(i) = 1; in the case of intensities, δ(i) = λ(i) > 0. Let P denote the set of strictly
positive distributions parameterized by δ.
Definition 1.1. Let S = {S1 , . . . , SJ }, be a class of non-empty subsets of the table I, A a
J × |I| matrix with entries
�
1, if the i-th cell is in Sj ,
aji = Ij (i) =
0, otherwise,
2

for i = 1, . . . , |I| and j = 1, . . . , J.

(1)

A relational model RM (S) ⊆ P with the model matrix A is the subset of P satisfying the
equation:

log δ = A� β,

(2)

for some β ∈ RJ .
Under the model (2) the parameters of the distribution can also be written as
δ(i) = exp {

J
�
j=1

J
�
Ij (i)βj } =
(θj )Ij (i) ,

(3)

j=1

where θj = exp (βj ), for j = 1, . . . , J.
The parameters β in (2) are called the log-linear parameters. The parameters θ in (3)
are called the multiplicative parameters. If the subsets in S are cylinder sets, the parameters
β coincide with the parameters of the corresponding log-linear model.
In the case δ = p it must be assumed that ∪Jj=1 Sj = I, i.e. there are no zero columns in

the matrix A. A zero column implies that one of the probabilities is 1 under the model and
the model is thus trivial.

The example below describes a model of conditional independence as a relational model.
Example 1.1. Consider the model of conditional independence [Y1 Y3 ][Y2 Y3 ] of three binary
variables Y1 , Y2 , Y3 , each taking values in {0, 1}. The model is expressed as
pi+k p+jk
pijk =
,
p++k
where pi+k , p+jk , p++k are marginal probabilities in the standard notation (Bishop et al.,
1975). Let S be the class consisting of the cylindrical sets associated with the empty marginal
and the marginals Y1 , Y2 Y3 , Y1 Y3 , Y2 Y3 . The model matrix computed from (1) is not full
row rank and thus the model parameters are not identifiable (cf. Section 2). A full row
rank model matrix can be obtain by setting, for instance, the level 0 of each variable as the
reference level. After that, the model matrix

1 1 1
 0 0 0

 0 0 1
A=
 0 1 0

 0 0 0
0 0 0

is equal to
1
0
1
1
0
1

1
1
0
0
0
0

1
1
0
1
1
0

1
1
1
0
0
0

1
1
1
1
1
1










(4)

The first row corresponds to the cylindrical set associated with the empty marginal. The
next three rows correspond to the cylindrical sets generated by the level 1 of Y1 , Y2 , Y3
respectively. The fifth row corresponds to the cylindrical set generated by the level 1 for
both Y1 and Y3 , and the last row - to the cylindrical set corresponding to the level 1 for both
Y2 and Y3 .
3

Table 1: Poisson intensities by bait type.
Fish
Yes No
λ00 λ01
λ10
-

Sugarcane
Yes
No

In the next example, one of the cells in the Cartesian product of the domains of the
variables is empty and the sample space I is a proper subset of this product.
Example 1.2. The study described by Kawamura et al. (1995) compared three bait types
for trapping swimming crabs: fish alone, sugarcane alone, and sugarcane-fish combination.
During the experiment, catching traps without bait was not considered. Three Poisson random variables are used to model the amount of crabs caught in the three traps. The notation
for the intensities is shown in Table 1. The model assuming that there is a multiplicative
eﬀect of using both bait types at the same time will be tested in this paper. The hypothesis
of interest is
λ00 = λ01 λ10 .

(5)

The eﬀect can be tested using the relational model for rates on the class S consisting of
two subsets: S = {S1 , S2 }, where S1 = {(0, 0), (0, 1)} and S2 = {(0, 0), (1, 0)}:
log λ = A� β,
Here, the model matrix
A=

�

1 1 0
1 0 1

�

,

and β = (β1 , β2 )� . The relationship between the two forms of the model will be explored in
the next section.

Table 2: Number of trapped Charybdis japonica by bait type.

Sugarcane
Yes
No

Fish
Yes No
36
2
11
-

Table 3: Number of trapped Portunuspelagicus by bait type.

Sugarcane
Yes
No

4

Fish
Yes No
71
3
44
-

2

Parameterizations and Degrees of Freedom

A choice of subsets in S = {S1 , . . . , SJ } is implied by the statistical problem, and the
relational model RM (S) can be parameterized with diﬀerent model matrices, which may be
useful depending on substantive meaning of the model. Sometimes a particular choice of
subsets leads to a model matrix A with linearly dependent rows and thus non-identifiable
model parameters. To ensure identifiability, a reparameterization, that is sometimes referred
to as model matrix coding, is needed. Examples of frequently used codings are reference
coding, eﬀects coding, orthogonal coding, polynomial coding (cf. Christensen, 1997).
Write R(A) for the row space of A and call it the design space of the model. The elements
of R(A) are |I|-dimensional row-vectors and 1 denotes the row-vector with all components

equal to 1. Reparameterizations of the model have form β = Cβ 1 , where β 1 are the new
parameters of the model and C is a J × [rank(A)] matrix such that the modified model
matrix C� A has a full row rank and R(A) = R(C� A). Then R(A)⊥ = R(C� A)⊥ , that is
Ker (A) = Ker (C� A).
Let P = Pδ = {Pδ : δ ∈ N } be the set of all positive distributions on the table I.
Here the parameter space N is an open subset of R|I| . Suppose Θ ⊂ N . Then the set
P0 = {Pδ : δ ∈ Θ ⊂ N } is a model in Pδ . The number of degrees of freedom of the model
P0 is the diﬀerence between dimensionalities of N and Θ.

Theorem 2.1. The number of degrees of freedom in a relational model RM (S) is |I| −
dimR(A).
�
Proof. Let δ = p = (p(1), . . . , p(|I|)� . Since i∈I p(i) = 1, then the parameter space N is
|I| − 1-dimensional. If RM (S) is a relational model for probabilities (3), its multiplicative
parameters θ must satisfy the normalizing equation

J
��
(θj )Ij (i) = 1.

(6)

i∈I j=1

Since the model matrix is full row rank, then the set Θ = {θ ∈ RJ+ :

�

i∈I

�J

Ij (i)
j=1 (θj )

= 1}

is a J − 1-dimensional surface in R . Therefore, the number of degrees of freedom of RM (S)
J

is dimN − dimΘ = |I| − 1 − (J − 1) = |I| − dimR(A).
|I|
Let δ = λ and RM (S) is a model for intensities. In this case, N = {λ ∈ R+ } and

Θ ⊂ N consists of all λ satisfying (3). Since no normalization is needed, dimN = |I|
and dimΘ = dimR(A) and thence the number of degrees of freedom of RM (S) is equal to
|I| − dimR(A).
The theorem implies that the number of degrees of freedom of the relational model
coincides with dim Ker(A). This is in coherence with the fact that the kernel of the model
5

matrix is invariant of reparameterizations of the model (2). To restrict further analysis to
models with a positive number of degrees of freedom suppose in the sequel that Ker(A) is
non-trivial. Without loss of generality, suppose further that the model matrix is full row
rank.
Definition 2.1. A matrix D with rows that form a basis of Ker(A) is called a kernel basis
matrix of the relational model RM (S).
The representation (2) is a primal (intuitive) representation of relational models; a dual
representation is described in the following theorem.
Theorem 2.2.

(i) The distribution, parameterized by δ, belongs to the relational model

RM (S) if and only if
Dlog δ = 0.

(7)

(ii) The matrix D may be chosen to have integer entries.
Proof.

(i) By the definition of a relational model,
Pδ ∈ RM (S) ⇔ log δ = A� β.

The orthogonality of the design space and the null space implies that AD� = 0 for any
kernel basis matrix D. The rows of D are linearly independent. Therefore
Pδ ∈ RM (S) ⇔ Dlog δ = DA� β = 0.
(ii) Since A has full row rank, then the dimension of Ker (A) is equal to K0 = |I| − J.
By Corollary 4.3b (Schrijver, 1986, pg. 49), there exists a unimodular matrix U, i.e.
U is integer and det U = ±1, such that AU is the Hermite normal form of A, that is
(a) AU has form [B, 0],
(b) B is a non-negative, non-singular, lower triangular matrix;
(c) AU is an n × m matrix with entries cij such that cij < cii for all i = 1, . . . , n, j =
1, . . . , m, i �= j.

Let IK0 stand for the K0 × K0 identity matrix, 0 denote the J × K0 zero matrix, and
Z be the following |I| × K0 matrix:

Z=

�

6

0
IK0

�

.

Since the matrix AU has form [B, 0] where B is the nonsingular, lower triangular,
J × J matrix, then (AU)Z = 0.
Set D� = UZ. Then
AD� = AUZ = 0.

(8)

The matrix U is integer and nonsingular, the columns of Z are linearly independent.
Therefore the matrix D� is integer and has linearly independent columns. Hence the
matrix D is an integer kernel basis matrix of the model.
Example 1.1 (Revisited) For the model of conditional independence dim Ker(A) = 2.
If the kernel basis matrix is chosen as
�
�
1 0 −1 0 −1 0 1 0
D=
,
0 1 0 −1 0 −1 0 1
the equation Dlog p = 0 is equivalent to the following constraints:
p000 p110
p001 p111
= 1,
= 1.
p010 p100
p011 p101
The latter is a well-known representation of the model [Y1 Y3 ][Y2 Y3 ] in terms of the conditional
odds ratios (Bishop et al., 1975).
The dual representation (7) of a relational model is, in fact, a model representation in
terms of some monomials in δ. All types of polynomial expressions that may arise in the
dual representation of a relational model are captured by the following definition.
�
�
Definition 2.2. Let u(i), v(i) ∈ Z≥0 for all i ∈ I, δ u = i∈I δ(i)u(i) and δ v = i∈I δ(i)v(i) .

A generalized odds ratio for a positive distribution, parameterized by δ, is a ratio of two
monomials:
OR = δ u/δ v .
The odds ratio OR =

δu
δv

is called homogeneous if

(9)
�

i∈I

u(i) =

�

i∈I

v(i).

To express a relational model RM (S) in terms of generalized odds ratios, write the rows
d1 , d2 , . . . , dK0 ∈ Z|I| of a kernel basis matrix D in terms of their positive and negative parts:
−
dl = d+
l − dl ,
−
where d+
l , dl ≥ 0 for all l = 1, 2, . . . , K0 . Then the model (7) takes form
−
d+
l log δ = dl log δ, for l = 1, 2, . . . , K0 ,

which is equivalent to the model representation in terms of generalized odds ratios:
+

−

δ dl /δ dl = 1, for l = 1, 2, . . . , K0 .
7

(10)

The number of degrees of freedom is equal to the minimal number of generalized odds ratios
required to uniquely specify a relational model.
Example 1.2 (Revisited) The model λ00 = λ01 λ10 can be expressed in the matrix
form as:
Dlog λ = 0,

(11)

where D = (1, −1, −1). The matrix D is a kernel basis matrix of the relational model, as
one would expect. Finally, the model representation in terms of generalized odds ratios is
λ00
= 1.
λ01 λ10

The role of generalized odds ratios in parameterizing distributions in P will be explored

in Section 4.

3

Relational Models as Exponential Families: Poisson
vs Multinomial Sampling

The representation (3) implies that a relational model is an exponential family of distributions. The canonical parameters of a relational model are βj ’s and the canonical statistics
are indicators of subsets Ij . Relational models for intensities and relational models for probabilities are considered in this section in more detail.
Let RMλ(S) denote a relational model for intensities and RMp(S) denote a relational
model for probabilities with the same model matrix A, that has a full rank J.
If the distribution of a random vector Y is parameterized by intensities λ, then, under
the model RMλ(S),
P (Y = y) = �

1
exp {β � Ay − 1expA� β}.
i∈I y(i)!

(12)

If the distribution of Y is multinomial, with parameters N and p, then, under the model
RMp(S),
N!
P (Y = y) = �
exp {β � Ay}.
(13)
y(i)!
i∈I
Set

T (Y ) = AY = (T1 (Y ), T2 (Y ), . . . , TJ (Y ))� .
(14)
�
For each j ∈ 1, . . . , J, the statistic Tj (Y ) = i∈I Ij (i)Y (i) is the subset sum corresponding
to the subset Sj .

8

Theorem 3.1. A model RMλ(S) is a regular exponential family of order J.
Proof. The model matrix A has full rank; no normalization is needed for intensities. Therefore, the representation (12) is minimal and the exponential family is regular, of order J.
Relational models for probabilities may have a more complex structure than relational
models for intensities and, in some cases, become curved exponential families (Efron, 1975;
Brown, 1988; Kass & Vos, 1997).
Theorem 3.2. If 1 ∈ R(A), a model RMp(S) is a regular exponential family of order J − 1;
otherwise, it is a curved exponential family of order J − 1.
Proof. Suppose that 1 ∈ R(A). Without loss of generality, I = S1 ∈ S and thus
J �
�
N!
P (Y = y) = �
exp {N β1 +
(
y(i)Ij (i))βj }.
i∈I y(i)!
j=2 i∈I

(15)

The exponential family representation given by (15) is minimal; the model RMp(S) is a
regular exponential family of order J − 1.
If 1 ∈
/ R(A) then, independent of parameterization, the model matrix does not include

the row of all 1s. The normalization is required and thus the parameter space is a manifold
of the dimension J − 1 in RJ (see e.g. Rudin, 1976, p.229). In this case, RMp(S) is a curved
exponential family of the order J − 1 (Kass & Vos, 1997).

If a relational model is a regular exponential family, the maximum likelihood estimate
of the canonical parameter exists if and only if the observed value of the canonical statistic
is contained in the interior of the convex hull of the support of its distribution (BarndorﬀNielsen & Cox, 1994). In this case, the MLE is also unique.
It is well known for log-linear models that, when the total sample size is fixed, the kernel
of the likelihood is the same for the multinomial and Poisson sampling scheme and thus
the maximum likelihood estimates of the cell frequencies, obtained under either sampling
scheme, are equal (see e.g. Bishop et al., 1975, p.448). The following theorem is an extension
of this result.
Theorem 3.3. Assume that, for a given set of observations, the maximum likelihood estiˆ under the model RMλ(S), and p
ˆ , under the model RMp(S), exist. The following
mates λ,
four conditions are equivalent:
(A) The MLEs for cell frequencies obtained under either model are the same.
(B) Vector 1 is in the design space R(A).
9

(C) Both models may be defined by homogeneous odds ratios.
(D) The model for intensities is scale invariant.
Proof. (A) ⇐= (B)

The maximum likelihood estimates for probabilities, under the model RMp(S), satisfy

the likelihood equations
Ay = αAˆ
p

(16)

1ˆ
p = 1.
Here α is the Lagrange multiplier.
If 1 ∈ R(A) then there exists a k ∈ RJ such that k� A = 1. Multiplying both sides of
the first equation in (16) by k� yields α = N and hence
Ay = N Aˆ
p.

(17)

The maximum likelihood estimates for intensities, under RMλ(S), satisfy the likelihood
equations
ˆ
Ay = Aλ.

(18)

From the equations (17) and (18):
ˆ − Np
ˆ ∈ Ker A.
λ
ˆ − Np
ˆ Therefore
ˆ ) = 0 and N = 1λ.
The latter implies that 1(λ
ˆ=
p

ˆ
λ
ˆ
1λ

and the maximum likelihood estimates for cell frequencies obtained under either model are
the same:
ˆ
ˆ = Np
ˆ = λ.
y
(A) =⇒ (B)
ˆ Under the model RMλ(S)
ˆ = Np
ˆ = λ.
Suppose that y
ˆ = A� β
ˆ1
log (λ)
ˆ 1 . On the other hand, under the model RMp(S),
for some β
ˆ = log (N p
ˆ + log N 1�
ˆ ) = A� β
log (λ)
2
10

ˆ . The condition A� β
ˆ = A� β
ˆ + log N 1� can only hold if 1 ∈ R(A).
for some β
2
1
2
(B) ⇐⇒ (C)

The vector 1 ∈ R(A) if and only if all rows of a kernel basis matrix D are orthogonal to
1 and the sum of entries in every row of D is zero. The latter is equivalent to the generalized
odds ratios obtained from rows of D being homogeneous.
(D) ⇐⇒ (B)

Let t > 0, t �= 1.
Dlog (tλ) = 0 ⇐⇒ log t · (D1� ) = 0 ⇐⇒ D1� = 0, or 1 ∈ R(A).

Corollary 3.4. For a given set of observations, the MLEs of the subset sums under a model
RMp(S) are equal to their observed values if and only if 1 ∈ R(A).
Proof. If 1 ∈ R(A) the model RMp(S) is a regular exponential family. The subset sums are
canonical statistics; their MLEs are the same as observed.

Suppose that the MLEs of the subset sums are equal to their observed values. Then
�
�
�
ˆ ∈ KerA. Since (p(i) − pˆ(i)) = p(i) − pˆ(i) = 1 − 1 = 0,
N Ap = N Apˆ and thus p − p
ˆ is orthogonal to 1 and thus 1 ∈ R(A).
vector p − p
Corollary 3.5. Suppose 1 ∈
/ R(A). For a given set of observations, the MLEs, if exist, of
the subset sums under a model RMp(S) are proportional to their observed values.
Proof. In this case the value of α cannot be found from (16) and one can only assert that
Ay =

α
Aˆ
y.
N

Example 1.2 illustrates a situation when a relational model for intensities is not scale
invariant. This model is a curved exponential family. The existence and uniqueness of the
maximum likelihood estimates in such relational models is proved next.
Theorem 3.6. Let Y ∼ M (N, p), y be a realization of Y , and RMp(S) be a relational
model, given 1 ∈
/ R(A). The maximum likelihood estimate for p, under the model RMp(S),
exists and unique if and only if T (y) > 0.

Proof. A point in the canonical parameter space of the model RMp(S) that maximizes
the log-likelihood subject to the normalization constraint is a solution to the optimization
problem:
max l(β; y),
s.t. β∈D
11

where
l(β; y) = T1 (y)β1 + · · · + TJ (y)βJ
and
D = {β ∈

RJ−

:

�

exp{

J
�
j=1

i∈I

Ij (i)βj } − 1 = 0}.

The set D is non-empty and is a level set of a convex function. The level sets of convex
functions are not convex in general. However the sub-level sets of convex functions and hence
the set
J
�
�
D≤ = {β ∈ RJ− :
exp{
Ij (i)βj } − 1 ≤ 0}
j=1

i∈I

are convex.

The set of maxima of l(β; y) over the set D≤ is nonempty and consists of a single point

if and only if (Bertsekas, 2009, Section 3)

RD≤ ∩ R−l = LD≤ ∩ L−l .
Here RD≤ is the recession cone of the set D≤ , R−l is the recession cone of the function −l,
LD≤ is the lineality space of D≤ , and L−l is the lineality space of −l.

The recession cone of D≤ is the orthant RJ− , including the origin; the lineality space is
LD≤ = {0}. The lineality space of the function −l is the plane passing through the origin,
with the normal T(y); the recession cone of −l is the half-space above this plane. The

condition RD≤ ∩ R−l = LD≤ ∩ L−l = {0} holds if and only if all components of T(y) =
(T1 (y), . . . , TJ (y))� are positive.
The function l(β; y) is linear; its maximum is achieved on D. Therefore there exists one
and only one β which maximizes the likelihood over the canonical parameter space and the
maximum likelihood estimate for p, under the model RMp(S), exists and unique.

Table 4: The MLEs for the Number of trapped
Charybdis japonica by bait type

Sugarcane
Yes
No

Fish
Yes No
35.06 2.94
11.94
-

Table 5: The MLEs for the Number of trapped
Portunuspelagicus by bait type.

Sugarcane
Yes
No

Fish
Yes No
72.31 1.69
42.69
-

Example 1.2 (Revisited) In this example, the relational model for intensities is not
scale invariant. The maximum likelihood estimates for the cell frequencies exist and are
12

shown in Tables 4 and 5. The observed Pearson’s statistics are X 2 = 0.40 and X 2 = 1.07
respectively, on one degree of freedom.
The relational models framework deals with models generated by subsets of cells, and
the model matrix for a relational model is an indicator matrix that has only 0-1 entries.
Theorems 2.2, 3.3 hold if the model matrix has non-negative integer entries. The next
example illustrates how the techniques and theorems apply to some discrete exponential
models.
Example 3.1. This example, given in (Agresti, 2002), describes the study carried out to
determine if a pneumonia infection has an immunizing eﬀect on dairy calves. Within 60
days after birth, the calves were exposed to a pneumonia infection. The calves that got the
infection were then classified according to whether or not they got the secondary infection
within two weeks after the first infection cleared up. The number of the infected calves
is thus a random variable with the multinomial distribution M (N, (p11 , p12 , p22 )� ), where N
denotes the total number of calves in the sample. Suppose further that p11 is the probability
to get both the primary and the secondary infection, p12 is the probability to get only the
primary infection and not the secondary one, and p22 is the probability not to catch either the
primary or the secondary infection. Let 0 < π < 1 denote the probability to get the primary
infection. The hypothesis of no immunizing eﬀect of the primary infection is expressed as
(cf. Agresti, 2002)
p11 = π 2 , p12 = π(1 − π), p22 = 1 − π.

(19)

Since the model (19) is also expressed in terms of non-homogeneous odds ratios:
p11 p222
= 1,
p212
then it is a relational model for probabilities, without the overall eﬀect.
Write N11 , N12 , N22 for the number of calves in each category and n11 , n12 , n22 for their
realizations. The log-likelihood is proportional to
(2n11 + n12 )log π + (n12 + n22 )log (1 − π).
The canonical statistic T = (T1 , T2 ) = (2N11 + N12 , N12 + N22 ) is two-dimensional; the
canonical parameter space {(log π, log (1 − π)) : π ∈ (0, 1)} is the curve in R2 shown on
Figure 1. The model (19) is thus a curved exponential family of order 1.
The likelihood is maximized by
π
ˆ=

2n11 + n12
T1
=
,
2n11 + 2n12 + n22
T1 + T2
13

log π

0

log (1 − π)

Figure 1: The canonical parameter space in Example 3.1.
where T1 = 2n11 + n12 and T2 = n12 + n22 are observed components of the canonical statistic,
or subset sums. The MLEs of the subset sums can be expressed in terms of their observed
values as
2T12
T1 T2
N (2T1 + T2 )
+
)
=
T
,
1
(T1 + T2 )2 (T1 + T2 )2
(T1 + T2 )2
T1 T2
T2
N (2T1 + T2 )
= N (ˆ
π (1 − π
ˆ ) + (1 − π
ˆ )) = N (
+
)
=
T
.
2
(T1 + T2 )2 T1 + T2
(T1 + T2 )2

Tˆ1 = N (2ˆ
π2 + π
ˆ (1 − π
ˆ )) = N (
Tˆ2

Thus, under the model (19), the MLEs of the subset sums diﬀer from their observed values
by the factor
0.936.

N (2T1 +T2 )
.
(T1 +T2 )2

For the data and the MLEs in Table 6, this factor is approximately

Table 6: Observed Counts for Primary and Secondary Pneumonia Infection of Calves. The
MLEs are shown in parentheses (Agresti, 2002).

Primary Infection
Yes
No

Secondary Infection
Yes
No
30 (38.1) 63 (39.0)
63 (78.9 )

14

4

Mixed Parameterization of Exponential Families

Let Pδ be an exponential family formed by all strictly positive distributions on I and log δ
be the canonical parameters of this family. Denote by Pγ the reparameterization of Pδ
defined by the following one-to one mapping:
log δ = M� γ,

(20)

where M is a full rank, |I| × |I|, integer matrix, and γ ∈ R|I| . It was shown by Brown
(1988) that Pγ is an exponential family with the canonical parameters γ.

Theorem 4.1. The canonical parameters of Pγ are the generalized log odds ratios in terms
of δ.

Proof. Since the matrix M is full rank, then
γ = (M� )−1 log δ.

(21)

Let B denote the adjoint matrix to M� and write b1 , . . . , b|I| for the rows of B. The components of γ can be expressed as:
γi =

1
log δ bi , for i = 1, . . . , |I|.
det(M)

(22)

All rows of B are integer vectors and thus the components of γ are multiples of the generalized
log odds ratios. The common factor 1/det(M) �= 0 can be included in the canonical statistics,
and the canonical parameters become equal to the generalized log odds ratios.

Let A be a full row rank J × |I| matrix with non-negative integer entries, and D denote

a kernel basis matrix of A. Set

M=
find the inverse of M and partition it as

�

A
D

�

,

(23)

�
�
M−1 = A− , D− .

Since DA� = 0, then (D− )� A− = 0. This matrix M can be used to derive a mixed parameterization of P with variation independent parameters (cf. Brown, 1988; Hoﬀmann-Jørgensen,
1994). Under this parameterization,

δ �−→

�
15

ζ1
ζ2

�

,

(24)

where ζ 1 = Aδ (mean-value parameters) and ζ 2 = D− log δ (canonical parameters), and the
range of the vector (ζ 1 , ζ 2 )� is the Cartesian product of the separate ranges of ζ 1 and ζ 2 .
Another mixed parameterization, which does not require calculating the inverse of M,
|I|

may be obtained as follows. Notice first that for any δ ∈ R+ there exist unique vectors
β ∈ RJ and θ ∈ R|I|−J such that

log δ = A� β + D� θ.

(25)

By orthogonality,
Dlog δ = 0 + DD� θ
θ = (DD� )−1 Dlog δ

(26)

Because of the uniqueness, D− = (DD� )−1 D. Moreover, since there is one-to-one correspondence between ζ and ζ˜ = Dlog δ, then, in the mixed parameterization, the parameter ζ
2

2

2

can be replaced with ζ˜ 2 . The components of ζ˜ 2 = Dlog δ are some generalized log odds
ratios as well.
A relational model is clearly defined and parameterized in the mixed parameterization
derived from the model matrix of this model. In this parameterization the model requires logs
of the generalized odds ratios to be zero and distributions in this model are parameterized
by the remaining mean-value parameters.
The following two examples illustrate the proposed mixed parameterization.
Example 1.1 (Revisited) Consider a 2 × 2 × 2 contingency table and matrices A and

D as in Example 1.1. From (25):

log p = A� β + θ1 · (1, 0, −1, 0, −1, 0, 1, 0)� + θ2 · (0, 1, 0, −1, 0, −1, 0, 1)� ,

(27)

for some β ∈ R6 and θ1 , θ2 ∈ R.

Since the rows of D are mutually orthogonal, then
(1, 0, −1, 0, −1, 0, 1, 0)log p = 4θ1 ,
(0, 1, 0, −1, 0, −1, 0, 1)log p = 4θ2 .

Thus, θ1 = 14 log (p111 p221 )/(p121 p211 ) and θ2 = 14 log (p112 p222 )/(p122 p212 ), as it is well known
(see e.g. Bishop et al., 1975).
The parameters β can be expressed as generalized log odds ratios by applying (22):
p3111 p121 p211
,
p221
p2 p2221
= log 121
,
p2111 p2211
p2 p2121 p2212 p2222
= log 111
,
p2112 p2122 p2211 p2221

p2211 p2221
,
p2111 p2121
p3 p122 p212 p221
β4 = log 112
,
p3111 p121 p211 p222
p2 p2122 p2211 p2222
β6 = log 111
.
p2112 p2121 p2212 p2221

β1 = log
β3
β5

β2 = log

16

The mean-value parameters for this family are ζ 1 = N Ap (the expected values of the subset
sums). The mixed parameterization consists of the mean-value parameters and the canonical
parameters ζ = (θ1 , θ2 )� or ζ˜ = Dlog p.
2

2

Some models, more general than relational models, can be specified by setting generalized
odds ratios equal to positive constants. An example of such model is given next.
Example 4.1. The Hardy-Weinberg distribution arising in genetics was discussed as an
exponential family in Barndorﬀ-Nielsen (1978); Brown (1988), among others. Assume that
a parent population contains alleles G and g with probabilities π and 1 − π respectively.
The number of genotypes GG, Gg, and gg, that appear in a generation of N descendants, is

a random variable with M (N, p) distribution. Under the model of random mating and no
selection, the vector of probabilities p has components
p1 = π 2 , p2 = 2π(1 − π), p3 = (1 − π)2 .

(28)

The model (28) is a one-parameter regular exponential family with the canonical parameter
log

π
.
1−π

This model is slightly more general than relational models, but the techniques used

for relational models apply. The model representation in terms of homogeneous odds ratios
is

p22
= 4.
p1 p3

(29)

If the kernel basis matrix is chosen as D = (−1, 2, −1) and the model matrix is
�
�
2 1 0
A=
,
0 1 2
the model (29) can be expressed as
Dlog p = 2log 2.
There exists a mixed parameterization of the family of multinomial distributions of the
form
log p = A� β + D� θ.

(30)

Here β = (β1 , β2 )� and θ ∈ (−∞, ∞). From the equation (26):
1
p2
θ = log 2 .
6
p1 p3
The parameter θ may be interpreted as a measure of the strength of selection in favor of the
heterozygote character Gg (cf. Brown, 1988).
The condition Dlog p = log 4 is equivalent to setting the parameter θ equal to 16 log 14 .
17

It is well known for a multidimensional contingency table that marginal distributions
are variation independent from conditional odds ratios. Properly selected conditional odds
ratios and sets of marginal distributions determine the distribution of the table uniquely
(Barndorﬀ-Nielsen, 1976; Rudas, 1998; Bergsma & Rudas, 2003). A generalization of this
fact to the set I is given in the following theorem.
Theorem 4.2. Let P be the set of all positive distributions on the table I. Suppose A is a

non-negative integer matrix of full row rank and D is a kernel basis matrix of A. Then the
following statements hold:
(i) For any Pδ1 , Pδ2 ∈ P there exists a distribution Pδ ∈ P and a scalar α such that
Aδ = αAδ 1 and Dlog δ = Dlog δ 2 .
(ii) The coeﬃcient of proportionality α = 1 if and only if 1 ∈ R(A).
The proof is straightforward, by Corollaries 3.4 and 3.5, and is omitted here.

5

Applications

The first example features relational models as a potential tool for modeling social mobility
tables. A model of independence is considered on a space that is not the Cartesian product
of the domains of the variables in the table.
Example 5.1. Social mobility tables often express a relation between statuses of two generations, for example, the relation between occupational statuses of respondents and their
fathers, as in Table 7 (Blau & Duncan, 1967). To test the hypothesis of independence between respondent’s mobility and father’s status, consider the Respondent’s mobility variable
with three categories: Upward mobile (moving up compared to father’s status), Immobile
(staying at the same status), and Downward mobile (moving down compared to father’s
status). The initial table is thence transformed into Table 8.
Table 7: Occupational Changes in a Generation, 1962
Father’s occupation
Respondent’s occupation
White-collar Manual Farm
White-collar
6313
2644
132
Manual
6321
10883
294
Farm
2495
6124
2471
Since respondents cannot move up from the highest status or down from the lowest status,
then the cells (1, 1) and (3, 3) in Table 8 do not exist. The set of cells I is a proper subset
18

Table 8: Father’s occupation vs Respondent’s mobility. The MLEs are shown in parentheses.
Father’s occupation
White-collar
Manual
Farm

Respondent’s mobility
Upward
Immobile
Downward
6313 (7518.17) 2776 (1570.83)
6321 (8823.66) 10883 (7175.18) 294 (1499.17)
8619 (6116.34) 2471 (4973.66)
-

of the Cartesian product of the domains of the variables in the table. Let S be the class
consisting of the cylindrical sets associated with the marginals, including the empty one.
The relational model generated by S has the model matrix


1 1 1 1 1 1 1
 1 1 0 0 0 0 0 



A=
 0 0 1 1 1 0 0 
 0 0 1 0 0 1 0 
1 0 0 1 0 0 1
and is expressed in terms of local odds ratios as follows:

p12 p23
p21 p32
= 1,
= 1.
p13 p22
p22 p31
This model is a regular exponential family of order 4; the maximum likelihood estimates
of cell frequencies exist and are unique. (The estimates are shown in Table 8 next to the
observed values.) The observed X 2 = 6995.83 on two degrees of freedom provides an evidence
of strong association between father’s occupation and respondent’s mobility.
The next example illustrates the usefulness of relational models for network analysis.
Example 5.2. Table 9 shows the total trade data between seven European countries that
was collected from United Nations Commodity Trade Statistics Database (2007). Every cell
contains the value of trade volume for a pair of countries; cell counts are assumed to have
Poisson distribution. The two hypotheses of interest are: countries with larger economies
generate more trade, and trade volume between two countries is higher if they use the same
currency. In this example, GDP (gross domestic product) is is chosen as the characteristic of
economy and Eurozone membership is chosen as the common currency indicator. The class
S includes five subsets of cells reflecting the GDP size:
{GDP < 0.1 · 106
{GDP < 0.1 · 106
{GDP < 0.1 · 106
{0.1 · 106 ≤ GDP
{0.1 · 106 ≤ GDP

vs GDP < 0.1 · 106 },
vs 0.1 · 106 ≤ GDP < 0.6 · 106 },
vs GDP ≥ 0.6 · 106 },
< 0.6 · 106 vs 0.1 · 106 ≤ GDP < 0.6 · 106 },
< 0.6 · 106 vs GDP ≥ 0.6 · 106 },
19

and three subsets reflecting Eurozone membership:
{cells, showing trade between two Eurozone members },
{cells, showing trade between a Eurozone member and a non-member },
{cells, showing trade between two Eurozone non-members}.
Under the model generated by S, trade volume is the product of the GDP eﬀect and the
Eurozone membership eﬀect.
Table 9: Total trade between seven countries (in billions US dollars). The MLEs are shown
in parentheses.

LV
NLD
FIN
EST
SWE
BEL
LUX

LV
[0]
-

NLD
FIN
EST
SWE
BEL
LUX
0.7 (3.29) 1 (1.17) 2 (2.0) 1.3 (1.17) 0.4 (1.17) 0.01 (0.01)
[0]
10 (17) 1 (1.17)
17 (15)
102 (102) 2.1 (2.29)
[0]
4 (1.17)
18 (15)
4 (2.29)
0.1 (2.29)
[0]
2.6 (1.17) 0.5 (1.17) 0.01 (0.01)
[0]
15 (15)
0.35 (2.29)
[0]
9 (6.41)
[0]

This model is a regular exponential family of order 6. The maximum likelihood estimates
for cell frequencies exist and are unique. The observed X 2 = 20.16 on 14 degrees of freedom
yields the asymptotic p-value of 0.12; so the model fits the trade data well. Alternatively,
sensitivity of the model fit to other choices regarding GDP could also be studied.

References
Agresti, A. (2002). Categorical data analysis. New York: Wiley.
Barndorﬀ-Nielsen, O. E. (1976). Factorization of likelihood functions for full exponential
families. J. Roy. Statist. Soc. Ser.B , 38 , 37–44.
Barndorﬀ-Nielsen, O. E. (1978). Information and exponential families. New York: Wiley.
Barndorﬀ-Nielsen, O. E., & Cox, D. R. (1994). Inference and asymptotics. London: Chapman
& Hall.
Bergsma, W., & Rudas, T. (2003). On conditional and marginal association. Ann. Fac. Sci.
Toulouse, 11 , 455–468.
Bertsekas, D. P. (2009). Convex optimization theory. Nashua, NH: Athena Scientific.
Bishop, Y. M. M., Fienberg, S. E., & Holland, P. W. (1975). Discrete multivariate analysis:
Theory and practice. MIT.
20

Blau, P. M., & Duncan, O. D. (1967). The American occupational structure. New York:
John Wiley and Sons, Inc.
Brown, L. D. (1988). Fundamentals of statistical exponential families. Hayward, Calif.:
Institute of Mathematical Statistics.
Christensen, R. (1997). Log-linear models and logistic regression. New York: Springer.
Efron, B. (1975). Defining the curvature of a statistical problem (with applications to second
order eﬃciency). Ann. Statist., 3 , 1189–1242.
Goodman, L. A. (1968). The analysis of cross-classified data: independence, quasiindependence, and interaction in contingency tables with or without missing cells. J.
Amer. Statist. Assoc., 63 , 1091–1131.
Goodman, L. A. (1972). Some multiplicative models for the analysis of cross-classified data.
Proceedings of the Sixth Berkley Symposium on Mathematical Statistics and Probability.
Hara, H., Takemura, A., & Yoshida, R. (2009). Markov bases for two-way subtable sum
problems. J. Pure Appl. Algebra, 213 , 1507–1521.
Hauser, R. M. (1978). A structural model of the mobility table. Social Forces, 56 , 919–953.
Hoﬀmann-Jørgensen, J. (1994). Probability with a view toward statistics (Vol. 2). New York:
Chapman & Hall.
Hout, M. (1983). Mobility tables (Vol. 31). Sage Publications, Inc.
Kass, R. E., & Vos, P. W. (1997). Geometrical foundations of asymptotic inference. New
York: Wiley.
Kawamura, G., Matsuoka, T., Tajiri, T., Nishida, M., & Hayashi, M. (1995). Eﬀectiveness
of a sugarcane-fish combination as bait in trapping swimming crabs. Fisheries Research,
22 , 155–160.
Rudas, T. (1998). Odds ratios in the analysis of contingency tables (Vol. 119). Sage
Publications, Inc.
Rudin, W. (1976). Principles of mathematical analysis. McGraw-Hill.
Schrijver, A. (1986). Theory of linear and integer programming. New York: Wiley.
Tanner, M. A., & Young, M. A. (1985a). Modeling agreement among raters. J. Amer.
Statist. Assoc., 80 , 175–180.
Tanner, M. A., & Young, M. A. (1985b). Modeling agreement among raters. Psychological
Bulletin, 98 , 408–415.
United nations commodity trade statistics database.
http://comtrade.un.org/)

(2007).

(available

at

Zelterman, D., & Youn, T. I. (1992). Indicator models for social mobility tables. Comput.
Statist. Data Anal., 14 .
21

